# ======================================
# SECURITY ENVIRONMENT VARIABLES
# ======================================

# Basic Security Settings
NODE_ENV=production
SECURITY_MODE=strict

# JWT Configuration
JWT_SECRET=your-super-secure-jwt-secret-key-here-at-least-32-characters
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secure-jwt-refresh-secret-key-here
JWT_REFRESH_EXPIRES_IN=7d

# Encryption Keys
ENCRYPTION_KEY=your-32-character-encryption-key-here
HASH_SECRET=your-hash-secret-for-additional-security

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL=false
RATE_LIMIT_SKIP_FAILED=false

# Authentication Rate Limiting
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_ATTEMPTS=5
AUTH_RATE_LIMIT_LOCKOUT_DURATION=3600000

# File Upload Security
MAX_FILE_SIZE=10485760
ALLOWED_MIME_TYPES=image/jpeg,image/png,image/gif,image/webp,application/pdf
ALLOWED_EXTENSIONS=.jpg,.jpeg,.png,.gif,.webp,.pdf
ENABLE_MALWARE_SCANNING=true
QUARANTINE_FOLDER=./uploads/quarantine
VIRUS_SCAN_COMMAND=clamav {file}

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: https:
CSP_CONNECT_SRC='self'
CSP_FONT_SRC='self'
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC='self'
CSP_FRAME_SRC='none'
CSP_REPORT_ONLY=false
CSP_REPORT_URI=/api/security/csp-report

# HSTS Configuration
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# Security Headers
FRAME_OPTIONS=DENY
CONTENT_TYPE_OPTIONS=true
XSS_PROTECTION=true
REFERRER_POLICY=strict-origin-when-cross-origin

# Input Sanitization
STRIP_HTML=true
NORMALIZE_EMAIL=true
ESCAPE_SPECIAL_CHARS=true
MAX_STRING_LENGTH=10000
ALLOWED_HTML_TAGS=b,i,em,strong
SANITIZATION_STRICT_MODE=true

# SQL Injection Prevention
ENABLE_PREPARED_STATEMENTS=true
ENABLE_QUERY_LOGGING=true
BLOCK_SUSPICIOUS_PATTERNS=true
ENABLE_QUERY_VALIDATION=true
SQL_INJECTION_BLOCK_MODE=strict

# Security Testing
ENABLE_PENETRATION_TESTING=false
SECURITY_TEST_FREQUENCY=daily
SECURITY_REPORT_PATH=./logs/security-reports
SECURITY_ALERT_THRESHOLD=5

# CORS Configuration
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-CSRF-Token
CORS_EXPOSED_HEADERS=X-Request-ID,X-Security-Level

# Session Security
SESSION_SECRET=your-super-secure-session-secret-here
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict
SESSION_MAX_AGE=86400000

# CSRF Protection
CSRF_SECRET=your-csrf-secret-key-here
CSRF_TOKEN_LENGTH=32
CSRF_COOKIE_NAME=_csrf
CSRF_HEADER_NAME=X-CSRF-Token

# API Security
API_KEY_PREFIX=sk
API_KEY_LENGTH=32
API_RATE_LIMIT_PER_KEY=1000

# Password Security
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_MAX_AGE_DAYS=90
PASSWORD_HISTORY_COUNT=5
BCRYPT_SALT_ROUNDS=12

# Account Security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=3600000
PASSWORD_RESET_TOKEN_EXPIRY=3600000
EMAIL_VERIFICATION_TOKEN_EXPIRY=86400000

# Two-Factor Authentication
ENABLE_2FA=true
OTP_LENGTH=6
OTP_EXPIRY=300000
BACKUP_CODES_COUNT=10

# Security Monitoring
ENABLE_SECURITY_LOGGING=true
SECURITY_LOG_LEVEL=info
SECURITY_LOG_FILE=./logs/security.log
ENABLE_INTRUSION_DETECTION=true
SUSPICIOUS_ACTIVITY_THRESHOLD=10

# IP Security
ENABLE_IP_WHITELIST=false
IP_WHITELIST=127.0.0.1,::1
ENABLE_IP_BLACKLIST=true
IP_BLACKLIST_FILE=./config/ip-blacklist.txt
CHECK_IP_REPUTATION=true

# Database Security
DB_CONNECTION_LIMIT=10
DB_QUERY_TIMEOUT=30000
DB_SSL_MODE=require
DB_ENCRYPT_CONNECTION=true

# Redis Security (if using Redis for rate limiting)
REDIS_PASSWORD=your-redis-password-here
REDIS_TLS=true
REDIS_AUTH_REQUIRED=true

# Webhook Security
WEBHOOK_SECRET=your-webhook-secret-here
WEBHOOK_SIGNATURE_HEADER=X-Signature-256
WEBHOOK_TIMESTAMP_TOLERANCE=300

# External Service Security
EXTERNAL_API_TIMEOUT=10000
EXTERNAL_API_RETRIES=3
EXTERNAL_API_RATE_LIMIT=100

# Debug and Development
DEBUG_SECURITY=false
SECURITY_VERBOSE_LOGGING=false
ENABLE_SECURITY_METRICS=true
SECURITY_METRICS_INTERVAL=60000

# Production Overrides
# Uncomment these for production deployment
# RATE_LIMIT_MAX_REQUESTS=50
# AUTH_RATE_LIMIT_MAX_ATTEMPTS=3
# ENABLE_MALWARE_SCANNING=true
# CSP_REPORT_ONLY=false
# HSTS_PRELOAD=true
# ENABLE_PENETRATION_TESTING=false
# DEBUG_SECURITY=false
